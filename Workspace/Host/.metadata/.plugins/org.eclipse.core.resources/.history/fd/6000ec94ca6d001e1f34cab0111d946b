/*
 * structExercise_162.c
 *
 *  Created on: Oct 18, 2023
 *      Author: mariestahaab
 */

/* Question: Decode the given packet and print the values of different fields.
 *
 * 32-bit Packet Contents:
 *
 * 			|  ADDR_MODE  |  SHORT_ADDR  |  LONG_ADDR  |  SENSOR  |  BAT  |  PAYLOAD  |  STATUS  |  CRC  |
 * bits:   		   1			  2			    8			 3		  3		   12		   1		 2
 *
 */


#include <stdint.h>
#include <stdio.h>

typedef struct{
	uint8_t		crc			;
	uint8_t		status		;
	uint16_t	payload		;
	uint8_t		bat			;
	uint8_t		sensor		;
	uint8_t		longAddr	;
	uint8_t		shortAddr	;
	uint8_t		addrMode	;
} Packet_t;

void dispPacketValues(Packet_t *pPkt);
void getPacketValues(uint32_t *pVal);

int main(void){

	uint32_t testPacketValue = 0xFFFFABCD;

	Packet_t Packet;
	Packet_t *pPacket = &Packet;

	pPacket -> crc 			= testPacketValue & (0x11);
	pPacket -> status 		= 0;
	pPacket -> payload 		= 0;
	pPacket -> bat 			= 0;
	pPacket -> sensor 		= 0;
	pPacket -> longAddr 	= 0;
	pPacket -> shortAddr 	= 0;
	pPacket -> addrMode 	= 0;

	dispPacketValues(pPacket);

	return 0;
}

void getPacketValues(uint32_t *pVal){
	printf("Enter a 32-bit HEX Value: ");
	scanf("%X", pVal);
}

void dispPacketValues(Packet_t *pPkt){
	printf("Values are:\n");
	printf("CRC\t: %X\n"			,pPkt -> crc);
	printf("STATUS\t: %X\n"			,pPkt -> status);
	printf("PAYLOAD\t: %X\n" 		,pPkt -> payload);
	printf("BAT\t: %X\n" 			,pPkt -> bat);
	printf("SENSOR\t: %X\n" 		,pPkt -> sensor);
	printf("LONG_ADDR\t: %X\n"	 	,pPkt -> longAddr);
	printf("SHORT_ADDR\t: %X\n" 	,pPkt -> shortAddr);
	printf("ADDR_MODE\t: %X\n" 		,pPkt -> addrMode);
}
